<!DOCTYPE html>
<html>
    <body>
        <script>
            function register_staff() {
                var http = new XMLHttpRequest();
                var url = '/registerstaff';
                var message = "fname=" + document.getElementById("staff_fname").value + "&lname=" + document.getElementById("staff_lname").value + "&role=" + document.getElementById("staff_role").value;

                http.open('POST', url, true);

                http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

                http.onreadystatechange = function() 
                { 
                    if(http.readyState == 4) 
                    {
                        if (http.status == 200) {
                            var response = JSON.parse(http.responseText);
                            alert(response);
                        }
                        else {
                            alert("Registration failure!");
                        }
                    }
                };

                http.send(message);
            };

            function refresh_staff_list() {
                var http = new XMLHttpRequest();
                var url = '/refreshstaff';

                http.open('POST', url, true);

                http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

                http.onreadystatechange = function() 
                { 
                    if(http.readyState == 4) 
                    {
                        if (http.status == 200) {
                            var response = JSON.parse(http.responseText);
                            document.getElementById("staff_display").value = "";
                            if (response.answer == "No staff!") {
                                document.getElementById("staff_display").value = "No staff!";
                            }
                            else {
                                for (let i=0; i<response.answer.length; i++) {
                                    document.getElementById("staff_display").value += "ID: " + response.answer[i].ID + "   FIRST NAME: " + response.answer[i].firstname + "   LAST NAME: " + response.answer[i].lastname + "   ROLE: " + response.answer[i].role + "   JOIN DATE: " + response.answer[i].joindate + "\n";
                                }
                            }
                        }
                    }
                };

                http.send("refresh");
            };
        </script>

        <h1>Staff Page</h1>

        <label>Register New Staff</label><br><br>
        <input id="staff_fname" type="text" name="staff_fname" placeholder="First Name">
        <input id="staff_lname" type="text" name="staff_lname" placeholder="Last Name">
        <input id="staff_role" type="text" name="staff_role" placeholder="Role"><br><br>
        <button onclick="register_staff()">Register</button><br><br><br><br>

        <label for="staff_display">Staff Display</label><br><br>
        <button onclick="refresh_staff_list()">Refresh Staff List</button><br><br>
        <textarea readonly name="staff_display" id="staff_display" cols="150" rows="30"></textarea>
    </body>
</html>